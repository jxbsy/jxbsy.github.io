import{_ as D,r as F,a as v,w as M,t as R,b as s,c as $,o as w,d as C,e as n,f as I,g as t,h as m,i as k,j as T,u as Z,k as H,l as K,F as Q}from"./index.fa64927c.js";import{_ as L}from"./lodash.0046eb4d.js";import{M as W}from"./mock.f0398b99.js";import{s as q,e as B}from"./apiResult.09ec0eb2.js";const X=e=>new Promise((o,i)=>{setTimeout(()=>{let l=S();l=l.filter(d=>d.name.indexOf(e.name)>=0);const a=l.length,u=(e.current-1)*e.size,f=u+e.size,r={current:e.current,size:e.size,total:a,records:l.slice(u,f)};o(q(r))},500)}),N=e=>new Promise((o,i)=>{setTimeout(()=>{const l=L.find(S(),a=>a.id===e);o(q(l))},500)}),x=e=>new Promise((o,i)=>{setTimeout(()=>{let l=S();if(j(l,null,e.phone)){i(B("\u624B\u673A\u53F7\u91CD\u590D\uFF0C\u8BF7\u66F4\u6362\u3002"));return}l.push({id:new Date().getTime(),...e}),P(l),o()},500)}),ee=()=>new Promise((e,o)=>{let i=S(),l=W.Random,a=new Date().getTime();for(let u=0;u<50;u++)i.push({id:--a,phone:l.integer(130,139)+l.string("number",8),name:l.cname(),gender:l.pick("\u7537","\u5973","\u4FDD\u5BC6"),birthday:l.date("yyyy-MM-dd"),address:l.county(!0)});P(i),e()}),oe=e=>new Promise((o,i)=>{let l=S();if(j(l,e.id,e.phone)){i(B("\u624B\u673A\u53F7\u91CD\u590D\uFF0C\u8BF7\u66F4\u6362\u3002"));return}const a=L.findIndex(l,u=>u.id===e.id);a>=0&&(l[a]=e,P(l)),o()}),le=e=>new Promise((o,i)=>{let l=S();L.remove(l,a=>a.id===e),P(l),o()});function j(e,o,i){return i?L.findIndex(e,l=>o?l.id!==o&&l.phone===i:(console.log(l.phone===i),l.phone===i))>=0:!1}function S(){let e=JSON.parse(sessionStorage.getItem("userList"));return e||(e=[]),e}function P(e){e&&sessionStorage.setItem("userList",JSON.stringify(e))}const te={props:{visible:Boolean,id:{required:!0,type:Number}},emits:["closed"],setup(e,o){const i=F(),l=v({isShow:!1,initLoading:!0,form:{}}),a=u=>{typeof u=="function"&&u(),l.form={},o.emit("closed")};return M(()=>e.visible,(u,f)=>{u&&(l.initLoading=!0,N(e.id).then(r=>l.form=r.data).finally(()=>{l.initLoading=!1})),l.isShow=u}),{formRef:i,...R(l),handleClose:a}}};function ne(e,o,i,l,a,u){const f=s("el-descriptions-item"),r=s("el-descriptions"),d=s("el-dialog"),b=$("loading");return w(),C(d,{title:e.form.name?"\u7528\u6237\uFF1A"+e.form.name:"",modelValue:e.isShow,"onUpdate:modelValue":o[0]||(o[0]=_=>e.isShow=_),"before-close":l.handleClose},{default:n(()=>[I((w(),C(r,{border:"",column:2},{default:n(()=>[t(f,{label:"\u624B\u673A\u53F7","label-align":"right",width:"120px"},{default:n(()=>[m(k(e.form.phone),1)]),_:1}),t(f,{label:"\u59D3\u540D","label-align":"right"},{default:n(()=>[m(k(e.form.name),1)]),_:1}),t(f,{label:"\u6027\u522B","label-align":"right"},{default:n(()=>[m(k(e.form.gender),1)]),_:1}),t(f,{label:"\u751F\u65E5","label-align":"right"},{default:n(()=>[m(k(e.form.birthday),1)]),_:1}),t(f,{label:"\u5730\u5740","label-align":"right",span:"2"},{default:n(()=>[m(k(e.form.address),1)]),_:1})]),_:1})),[[b,e.initLoading]])]),_:1},8,["title","modelValue","before-close"])}var re=D(te,[["render",ne]]);const ae={props:{visible:Boolean},emits:["closed","success"],setup(e,o){const{proxy:i}=T(),l=F(),a=v({isShow:!1,submitLoading:!1,form:{gender:"\u7537"},rules:v({phone:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",trigger:"blur"},{pattern:/^[1][0-9]{10}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u683C\u5F0F",trigger:"blur"}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"},{min:2,max:30,message:"2\u81F330\u4E2A\u5B57\u7B26",trigger:"blur"}]})}),u=r=>{typeof r=="function"&&r(),l.value.resetFields(),o.emit("closed")},f=()=>{l.value.validate(r=>{r&&(a.submitLoading=!0,x(a.form).then(()=>{o.emit("success"),u()}).catch(d=>i.$message({type:"error",message:d.msg})).finally(()=>a.submitLoading=!1))})};return M(()=>e.visible,(r,d)=>{a.isShow=r}),{formRef:l,...R(a),handleClose:u,handleSubmit:f}}};function se(e,o,i,l,a,u){const f=s("el-input"),r=s("el-form-item"),d=s("el-radio"),b=s("el-radio-group"),_=s("el-date-picker"),y=s("el-form"),g=s("el-button"),V=s("el-dialog");return w(),C(V,{title:"\u65B0\u589E",modelValue:e.isShow,"onUpdate:modelValue":o[5]||(o[5]=c=>e.isShow=c),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":l.handleClose},{footer:n(()=>[t(g,{onClick:l.handleClose},{default:n(()=>[m("\u53D6\u6D88")]),_:1},8,["onClick"]),t(g,{type:"primary",onClick:l.handleSubmit,loading:e.submitLoading},{default:n(()=>[m("\u786E\u5B9A")]),_:1},8,["onClick","loading"])]),default:n(()=>[t(y,{ref:"formRef","label-width":"80px",model:e.form,rules:e.rules},{default:n(()=>[t(r,{prop:"phone",label:"\u624B\u673A\u53F7"},{default:n(()=>[t(f,{modelValue:e.form.phone,"onUpdate:modelValue":o[0]||(o[0]=c=>e.form.phone=c),maxlength:11},null,8,["modelValue"])]),_:1}),t(r,{prop:"name",label:"\u59D3\u540D"},{default:n(()=>[t(f,{modelValue:e.form.name,"onUpdate:modelValue":o[1]||(o[1]=c=>e.form.name=c),maxlength:30},null,8,["modelValue"])]),_:1}),t(r,{prop:"gender",label:"\u6027\u522B"},{default:n(()=>[t(b,{modelValue:e.form.gender,"onUpdate:modelValue":o[2]||(o[2]=c=>e.form.gender=c)},{default:n(()=>[t(d,{label:"\u7537"},{default:n(()=>[m("\u7537")]),_:1}),t(d,{label:"\u5973"},{default:n(()=>[m("\u5973")]),_:1}),t(d,{label:"\u4FDD\u5BC6"},{default:n(()=>[m("\u4FDD\u5BC6")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(r,{prop:"birthday",label:"\u751F\u65E5"},{default:n(()=>[t(_,{modelValue:e.form.birthday,"onUpdate:modelValue":o[3]||(o[3]=c=>e.form.birthday=c),"value-format":"YYYY-MM-DD",type:"date",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(r,{prop:"address",label:"\u5730\u5740"},{default:n(()=>[t(f,{type:"textarea","show-word-limit":"",resize:"none",modelValue:e.form.address,"onUpdate:modelValue":o[4]||(o[4]=c=>e.form.address=c),maxlength:50},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","before-close"])}var ie=D(ae,[["render",se]]);const de={props:{visible:Boolean,id:{required:!0,type:Number}},emits:["closed","success"],setup(e,o){const{proxy:i}=T(),l=F(),a=v({isShow:!1,initLoading:!0,submitLoading:!1,form:{},rules:v({phone:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",trigger:"blur"},{pattern:/^[1][0-9]{10}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u683C\u5F0F",trigger:"blur"}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"},{min:2,max:30,message:"2\u81F330\u4E2A\u5B57\u7B26",trigger:"blur"}]})}),u=r=>{typeof r=="function"&&r(),l.value.resetFields(),o.emit("closed")},f=()=>{l.value.validate(r=>{r&&(a.submitLoading=!0,a.form.id=e.id,oe(a.form).then(()=>{o.emit("success"),u()}).catch(d=>i.$message({type:"error",message:d.msg})).finally(()=>a.submitLoading=!1))})};return M(()=>e.visible,(r,d)=>{r&&(a.initLoading=!0,a.submitLoading=!0,N(e.id).then(b=>a.form=b.data).finally(()=>{a.initLoading=!1,a.submitLoading=!1})),a.isShow=r}),{formRef:l,...R(a),handleClose:u,handleSubmit:f}}};function ue(e,o,i,l,a,u){const f=s("el-input"),r=s("el-form-item"),d=s("el-radio"),b=s("el-radio-group"),_=s("el-date-picker"),y=s("el-form"),g=s("el-button"),V=s("el-dialog"),c=$("loading");return w(),C(V,{title:"\u4FEE\u6539",modelValue:e.isShow,"onUpdate:modelValue":o[5]||(o[5]=p=>e.isShow=p),"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":l.handleClose},{footer:n(()=>[t(g,{onClick:l.handleClose},{default:n(()=>[m("\u53D6\u6D88")]),_:1},8,["onClick"]),t(g,{type:"primary",onClick:l.handleSubmit,loading:e.submitLoading},{default:n(()=>[m("\u786E\u5B9A")]),_:1},8,["onClick","loading"])]),default:n(()=>[I((w(),C(y,{ref:"formRef","label-width":"80px",model:e.form,rules:e.rules},{default:n(()=>[t(r,{prop:"phone",label:"\u624B\u673A\u53F7"},{default:n(()=>[t(f,{modelValue:e.form.phone,"onUpdate:modelValue":o[0]||(o[0]=p=>e.form.phone=p),maxlength:11},null,8,["modelValue"])]),_:1}),t(r,{prop:"name",label:"\u59D3\u540D"},{default:n(()=>[t(f,{modelValue:e.form.name,"onUpdate:modelValue":o[1]||(o[1]=p=>e.form.name=p),maxlength:30},null,8,["modelValue"])]),_:1}),t(r,{prop:"gender",label:"\u6027\u522B"},{default:n(()=>[t(b,{modelValue:e.form.gender,"onUpdate:modelValue":o[2]||(o[2]=p=>e.form.gender=p)},{default:n(()=>[t(d,{label:"\u7537"},{default:n(()=>[m("\u7537")]),_:1}),t(d,{label:"\u5973"},{default:n(()=>[m("\u5973")]),_:1}),t(d,{label:"\u4FDD\u5BC6"},{default:n(()=>[m("\u4FDD\u5BC6")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(r,{prop:"birthday",label:"\u751F\u65E5"},{default:n(()=>[t(_,{modelValue:e.form.birthday,"onUpdate:modelValue":o[3]||(o[3]=p=>e.form.birthday=p),"value-format":"YYYY-MM-DD",type:"date",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(r,{prop:"address",label:"\u5730\u5740"},{default:n(()=>[t(f,{type:"textarea","show-word-limit":"",resize:"none",modelValue:e.form.address,"onUpdate:modelValue":o[4]||(o[4]=p=>e.form.address=p),maxlength:50},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[c,e.initLoading]])]),_:1},8,["modelValue","before-close"])}var me=D(de,[["render",ue]]);const A=[10,20,30,50],fe={components:{ViewUser:re,AddUser:ie,UpdateUser:me},setup(){const e=F(),o=v({viewVisible:!1,addVisible:!1,updateVisible:!1,tableLoading:!1,id:0,searchForm:{name:""},pageSizes:A,current:1,size:A[0],tableData:{total:0,records:[]}}),i=()=>{o.tableLoading=!0,o.searchForm.current=o.current,o.searchForm.size=o.size,X(o.searchForm).then(p=>{o.tableData=p.data}).finally(()=>o.tableLoading=!1)},l=()=>{e.value.resetFields(),i()},a=p=>{o.id=p,o.viewVisible=!0},u=()=>{o.addVisible=!0},f=()=>{o.addVisible=!1},r=()=>{i()},d=p=>{o.id=p,o.updateVisible=!0},b=()=>{o.updateVisible=!1},_=()=>{i()},y=p=>{le(p).then(()=>{i()})},g=Z(),V=()=>{const p=g.currentRoute.value.path,U=g.getRoutes().filter(z=>z.path!==p&&z.redirect!==p);g.push(U[L.random(0,U.length-1)])},c=()=>{ee().then(()=>i())};return H(()=>{i()}),{searchFormRef:e,...R(o),search:i,reset:l,showView:a,showAdd:u,closeAdd:f,addSuccess:r,showUpdate:d,closeUpdate:b,updateSuccess:_,remove:y,handleRedirect:V,generateMockData:c}}};function pe(e,o,i,l,a,u){const f=s("el-input"),r=s("el-form-item"),d=s("el-button"),b=s("el-form"),_=s("el-col"),y=s("el-row"),g=s("el-table-column"),V=s("el-popconfirm"),c=s("el-link"),p=s("el-empty"),U=s("el-table"),z=s("el-pagination"),E=s("view-user"),O=s("add-user"),J=s("update-user"),G=$("loading");return w(),K(Q,null,[t(b,{ref:"searchFormRef","label-width":"50px","label-position":"left",inline:"",model:e.searchForm},{default:n(()=>[t(r,{prop:"name",label:"\u59D3\u540D"},{default:n(()=>[t(f,{modelValue:e.searchForm.name,"onUpdate:modelValue":o[0]||(o[0]=h=>e.searchForm.name=h)},null,8,["modelValue"])]),_:1}),t(r,null,{default:n(()=>[t(d,{type:"primary",onClick:l.search},{default:n(()=>[m("\u641C\u7D22")]),_:1},8,["onClick"]),t(d,{onClick:l.reset},{default:n(()=>[m("\u91CD\u7F6E")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"]),t(y,{style:{"margin-bottom":"18px"}},{default:n(()=>[t(_,{span:12}),t(_,{span:12},{default:n(()=>[t(d,{type:"success",style:{float:"right"},onClick:l.showAdd},{default:n(()=>[m("\u65B0\u589E")]),_:1},8,["onClick"])]),_:1})]),_:1}),I((w(),C(U,{border:"","header-align":"center",data:e.tableData.records},{empty:n(()=>[t(p,null,{description:n(()=>[m(" \u6682\u672A\u67E5\u8BE2\u5230\u6570\u636E\uFF0C\u60A8\u8FD8\u53EF\u4EE5 "),t(c,{type:"primary",onClick:l.handleRedirect},{default:n(()=>[m("\u968F\u4FBF\u901B\u901B")]),_:1},8,["onClick"]),m(" \u6216 "),t(c,{type:"success",onClick:l.generateMockData},{default:n(()=>[m("\u751F\u6210\u6A21\u62DF\u6570\u636E")]),_:1},8,["onClick"])]),_:1})]),default:n(()=>[t(g,{"header-align":"center",type:"index",label:"\u5E8F\u53F7",width:"60"}),t(g,{"header-align":"center",prop:"phone",label:"\u624B\u673A\u53F7",width:"120"}),t(g,{"header-align":"center",prop:"name",label:"\u59D3\u540D",width:"150"}),t(g,{"header-align":"center",prop:"gender",label:"\u6027\u522B",width:"60"}),t(g,{"header-align":"center",prop:"birthday",label:"\u751F\u65E5",width:"110"}),t(g,{"header-align":"center","show-overflow-tooltip":"",prop:"address",label:"\u5730\u5740"}),t(g,{label:"\u64CD\u4F5C",align:"center",fixed:"right",width:"200"},{default:n(h=>[t(d,{type:"primary",size:"small",onClick:Y=>l.showView(h.row.id)},{default:n(()=>[m("\u67E5\u770B")]),_:2},1032,["onClick"]),t(d,{type:"primary",size:"small",onClick:Y=>l.showUpdate(h.row.id)},{default:n(()=>[m("\u4FEE\u6539")]),_:2},1032,["onClick"]),t(V,{title:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u8BB0\u5F55\u5417\uFF1F","confirm-button-text":"\u786E\u5B9A","cancel-button-text":"\u53D6\u6D88",onConfirm:Y=>l.remove(h.row.id)},{reference:n(()=>[t(d,{type:"danger",size:"small"},{default:n(()=>[m("\u5220\u9664")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[G,e.tableLoading]]),t(z,{style:{"margin-top":"10px"},currentPage:e.current,"onUpdate:currentPage":o[1]||(o[1]=h=>e.current=h),pageSize:e.size,"onUpdate:pageSize":o[2]||(o[2]=h=>e.size=h),"page-sizes":e.pageSizes,layout:"total, sizes, prev, pager, next",total:e.tableData.total,onCurrentChange:l.search,onSizeChange:l.search},null,8,["currentPage","pageSize","page-sizes","total","onCurrentChange","onSizeChange"]),t(E,{visible:e.viewVisible,id:e.id,onClose:o[3]||(o[3]=h=>e.viewVisible=!1)},null,8,["visible","id"]),t(O,{visible:e.addVisible,onClosed:l.closeAdd,onSuccess:l.addSuccess},null,8,["visible","onClosed","onSuccess"]),t(J,{visible:e.updateVisible,id:e.id,onClosed:l.closeUpdate,onSuccess:l.updateSuccess},null,8,["visible","id","onClosed","onSuccess"])],64)}var he=D(fe,[["render",pe],["__scopeId","data-v-3781677a"]]);export{he as default};
